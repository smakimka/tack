# Tack
#### Про название:
tack - лавировать, менять направление. И одновременно кнопка, которыми, например закрепляют улики на карте в детекивных фильмах. Потом между нимим обязательно обматывают красную нитку, что напомниает то, как прокси перенаправляет трафик в интернете.

Проект представляет собой 2 небольших сервиса - Http прокси и сборщик/отображатель данных, отправляемых и сбоираемых этим прокси по своим клиентам.

## Прокси:
Сервис является tcp прокси, функионал хорошо описывается конфигом, потому пройдусь по нему:
```toml
name = "test"
logging_level = "debug"
monitor = true
monitor_addr = "127.0.0.1:8092"

[endpoints]

[endpoints.test]
addr = ":8090"
workers = 10
speed_limit = 5
total_limit = 10


[balancers]

[balancers.test]
addr=":8091"
type="round_robin"
addrs= ["127.0.0.1:9000", "127.0.0.1:9001", "127.0.0.1:9002"]
workers = 10
```
Имя, уровень логиирования, и параметры мониторинга говорят сами за себя. Важно что имя - обязательный параметр, и для корретного отображения данных у всех прокси должны быть разыне имена.

Далее идут эндпоинты и балансеры. Балансер это тоже эндпоинт, поэтому у него есть все те же параметры.

### Эндпоинт содержит в себе:
1. Адрес на котором запускается http слушатель
2. Количество работников (горутин), запускаемых для обработки соединений на этом адресе (один работник может обрабатывать только одно соединение, поэтому это и ограничение по количеству соединений)
3. Лимит по количеству соединений в секунду
4. Лимит по количеству одновременно установленных соединений
Первые 2 параметра обязательные

### Балансер содержит в себе:
1. Всё тоже, что и эндпоинт
2. Тип (алгоритм, по которому распределяются соединения (в данный момент только один))
3. Адреса, между которыми устанавливаются соединения

## Монитор
Сервис, который хранит данные, собираемые прокси, и простенько их отображает

## Инструкция по запуску
Прокси запускается с флагом -f "путь_к_конфигу"
```bash
proxy -f "config.toml"
```

Монитор запускается с флагом -a "адрес" на котором он будет слушать данные от прокси
```bash
monitor -a "localhost:8092"
```

Если запустить их одновременно и правильно настроить, так чтобы данные успешно отправлялись, то на "/" маршруте монитора появится название прокси, оно является гиперссылкой, по которой можно перейти и увидеть статус, последнее время контакта и список эндпоинтов и балансеров по которым собраны данные, на них тоже можно кликнуть и увидеть данные по клинетам

**Данные появятся только после закрытия соединения, и какого-то времени на отправку**
